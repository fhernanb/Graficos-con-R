<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>3 Gráficos para varias variables cuantitativas | Gráficos con R</title>
  <meta name="description" content="Libro de apoyo para los estudiantes de la Escuela de Estadística de la Universidad Nacional de Colombia.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="3 Gráficos para varias variables cuantitativas | Gráficos con R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="Libro de apoyo para los estudiantes de la Escuela de Estadística de la Universidad Nacional de Colombia." />
  <meta name="github-repo" content="fhernanb/Graficos-con-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Gráficos para varias variables cuantitativas | Gráficos con R" />
  
  <meta name="twitter:description" content="Libro de apoyo para los estudiantes de la Escuela de Estadística de la Universidad Nacional de Colombia." />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="Freddy Hernández">
<meta name="author" content="Juan Carlos Correa">


<meta name="date" content="2019-07-04">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="unacuanti.html">
<link rel="next" href="cuali.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Gráficos con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenido</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-libro"><i class="fa fa-check"></i>Estructura del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-y-convenciones"><i class="fa fa-check"></i>Software y convenciones</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bloques-informativos"><i class="fa fa-check"></i>Bloques informativos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sobre-los-autores.html"><a href="sobre-los-autores.html"><i class="fa fa-check"></i>Sobre los autores</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="unacuanti.html"><a href="unacuanti.html"><i class="fa fa-check"></i><b>2</b> Gráficos para una variable cuantitativa</a><ul>
<li class="chapter" data-level="2.1" data-path="unacuanti.html"><a href="unacuanti.html#funcion-stem"><i class="fa fa-check"></i><b>2.1</b> Función <code>stem</code>  </a><ul>
<li class="chapter" data-level="" data-path="unacuanti.html"><a href="unacuanti.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="unacuanti.html"><a href="unacuanti.html#funcion-boxplot"><i class="fa fa-check"></i><b>2.2</b> Función <code>boxplot</code> </a><ul>
<li class="chapter" data-level="" data-path="unacuanti.html"><a href="unacuanti.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="unacuanti.html"><a href="unacuanti.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="unacuanti.html"><a href="unacuanti.html#funcion-hist"><i class="fa fa-check"></i><b>2.3</b> Función <code>hist</code></a><ul>
<li class="chapter" data-level="" data-path="unacuanti.html"><a href="unacuanti.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="unacuanti.html"><a href="unacuanti.html#funcion-qqnorm-y-qqplot"><i class="fa fa-check"></i><b>2.4</b> Función <code>qqnorm</code> y <code>qqplot</code>  </a><ul>
<li class="chapter" data-level="" data-path="unacuanti.html"><a href="unacuanti.html#ejemplo-4"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="unacuanti.html"><a href="unacuanti.html#ejemplo-5"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="unacuanti.html"><a href="unacuanti.html#funcion-density"><i class="fa fa-check"></i><b>2.5</b> Función <code>density</code>  </a><ul>
<li class="chapter" data-level="" data-path="unacuanti.html"><a href="unacuanti.html#ejemplo-6"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="unacuanti.html"><a href="unacuanti.html#ejemplo-7"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="unacuanti.html"><a href="unacuanti.html#ejemplo-8"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="doscuanti.html"><a href="doscuanti.html"><i class="fa fa-check"></i><b>3</b> Gráficos para varias variables cuantitativas</a><ul>
<li class="chapter" data-level="3.1" data-path="doscuanti.html"><a href="doscuanti.html#funcion-plot"><i class="fa fa-check"></i><b>3.1</b> Función <code>plot</code>  </a><ul>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-9"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-10"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="doscuanti.html"><a href="doscuanti.html#funcion-sunflowerplot"><i class="fa fa-check"></i><b>3.2</b> Función <code>sunflowerplot</code> </a><ul>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-11"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-12"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="doscuanti.html"><a href="doscuanti.html#funcion-symbols"><i class="fa fa-check"></i><b>3.3</b> Función <code>symbols</code> </a><ul>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-13"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="doscuanti.html"><a href="doscuanti.html#funcion-pairs"><i class="fa fa-check"></i><b>3.4</b> Función <code>pairs</code> </a><ul>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-14"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-15"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-16"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-17"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-18"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="doscuanti.html"><a href="doscuanti.html#funcion-persp"><i class="fa fa-check"></i><b>3.5</b> Función <code>persp</code> </a><ul>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-19"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-20"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="doscuanti.html"><a href="doscuanti.html#funcion-contour"><i class="fa fa-check"></i><b>3.6</b> Función <code>contour</code>  </a><ul>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-21"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="doscuanti.html"><a href="doscuanti.html#funcion-filled.contour"><i class="fa fa-check"></i><b>3.7</b> Función <code>filled.contour</code>  </a><ul>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-22"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-23"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="doscuanti.html"><a href="doscuanti.html#funcion-image"><i class="fa fa-check"></i><b>3.8</b> Función <code>image</code> </a><ul>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-24"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="doscuanti.html"><a href="doscuanti.html#funcion-kde2d"><i class="fa fa-check"></i><b>3.9</b> Función <code>kde2d</code>  </a><ul>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-25"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="doscuanti.html"><a href="doscuanti.html#funcion-interaction.plot"><i class="fa fa-check"></i><b>3.10</b> Función <code>interaction.plot</code>  </a><ul>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-26"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="doscuanti.html"><a href="doscuanti.html#grafico-de-espagueti"><i class="fa fa-check"></i><b>3.11</b> Gráfico de espagueti </a><ul>
<li class="chapter" data-level="" data-path="doscuanti.html"><a href="doscuanti.html#ejemplo-27"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cuali.html"><a href="cuali.html"><i class="fa fa-check"></i><b>4</b> Gráficos para variables cualitativas</a><ul>
<li class="chapter" data-level="4.1" data-path="cuali.html"><a href="cuali.html#funcion-barplot"><i class="fa fa-check"></i><b>4.1</b> Función <code>barplot</code>  </a><ul>
<li class="chapter" data-level="" data-path="cuali.html"><a href="cuali.html#ejemplo-28"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="cuali.html"><a href="cuali.html#ejemplo-29"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="cuali.html"><a href="cuali.html#funcion-pie"><i class="fa fa-check"></i><b>4.2</b> Función <code>pie</code>  </a><ul>
<li class="chapter" data-level="" data-path="cuali.html"><a href="cuali.html#ejemplo-30"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="cuali.html"><a href="cuali.html#funcion-dotchart"><i class="fa fa-check"></i><b>4.3</b> Función <code>dotchart</code>  </a><ul>
<li class="chapter" data-level="" data-path="cuali.html"><a href="cuali.html#ejemplo-31"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="cuali.html"><a href="cuali.html#ejemplo-32"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cuali.html"><a href="cuali.html#ejercicios"><i class="fa fa-check"></i>EJERCICIOS</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="par.html"><a href="par.html"><i class="fa fa-check"></i><b>5</b> Función <code>par</code></a><ul>
<li class="chapter" data-level="5.1" data-path="par.html"><a href="par.html#parametro-ann"><i class="fa fa-check"></i><b>5.1</b> Parámetro <code>ann</code>  </a><ul>
<li class="chapter" data-level="" data-path="par.html"><a href="par.html#ejemplo-33"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="par.html"><a href="par.html#parametro-adj"><i class="fa fa-check"></i><b>5.2</b> Parámetro <code>adj</code>  </a><ul>
<li class="chapter" data-level="" data-path="par.html"><a href="par.html#ejemplo-34"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="par.html"><a href="par.html#parametro-bg"><i class="fa fa-check"></i><b>5.3</b> Parámetro <code>bg</code>  </a><ul>
<li class="chapter" data-level="" data-path="par.html"><a href="par.html#ejemplo-35"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="par.html"><a href="par.html#parametro-mfrow"><i class="fa fa-check"></i><b>5.4</b> Parámetro <code>mfrow</code>  </a><ul>
<li class="chapter" data-level="" data-path="par.html"><a href="par.html#ejemplo-36"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="par.html"><a href="par.html#parametro-bty"><i class="fa fa-check"></i><b>5.5</b> Parámetro <code>bty</code>  </a><ul>
<li class="chapter" data-level="" data-path="par.html"><a href="par.html#ejemplo-37"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="par.html"><a href="par.html#parametro-cex"><i class="fa fa-check"></i><b>5.6</b> Parámetro <code>cex</code>  </a><ul>
<li class="chapter" data-level="" data-path="par.html"><a href="par.html#ejemplo-38"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="par.html"><a href="par.html#parametros-cex.axis-cex.lab-cex.main-y-cex.sub"><i class="fa fa-check"></i><b>5.7</b> Parámetros <code>cex.axis</code>, <code>cex.lab</code>, <code>cex.main</code> y <code>cex.sub</code>    </a><ul>
<li class="chapter" data-level="" data-path="par.html"><a href="par.html#ejemplo-39"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="par.html"><a href="par.html#parametro-col-col.axis-col.lab-col.main-y-col.sub"><i class="fa fa-check"></i><b>5.8</b> Parámetro <code>col</code>, <code>col.axis</code>, <code>col.lab</code>, <code>col.main</code> y <code>col.sub</code>  </a><ul>
<li class="chapter" data-level="" data-path="par.html"><a href="par.html#ejemplo-40"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="auxiliares.html"><a href="auxiliares.html"><i class="fa fa-check"></i><b>6</b> Funciones auxiliares</a><ul>
<li class="chapter" data-level="6.1" data-path="auxiliares.html"><a href="auxiliares.html#funcion-segments"><i class="fa fa-check"></i><b>6.1</b> Función <code>segments</code>  </a></li>
<li class="chapter" data-level="6.2" data-path="auxiliares.html"><a href="auxiliares.html#funcion-rect"><i class="fa fa-check"></i><b>6.2</b> Función <code>rect</code>  </a></li>
<li class="chapter" data-level="6.3" data-path="auxiliares.html"><a href="auxiliares.html#funcion-polygon"><i class="fa fa-check"></i><b>6.3</b> Función <code>polygon</code>  </a></li>
<li class="chapter" data-level="6.4" data-path="auxiliares.html"><a href="auxiliares.html#funcion-abline"><i class="fa fa-check"></i><b>6.4</b> Función <code>abline</code> </a></li>
<li class="chapter" data-level="6.5" data-path="auxiliares.html"><a href="auxiliares.html#para-dibujar-un-circulo"><i class="fa fa-check"></i><b>6.5</b> Para dibujar un círculo </a></li>
<li class="chapter" data-level="6.6" data-path="auxiliares.html"><a href="auxiliares.html#funcion-arrows"><i class="fa fa-check"></i><b>6.6</b> Función <code>arrows</code>  </a></li>
<li class="chapter" data-level="6.7" data-path="auxiliares.html"><a href="auxiliares.html#funcion-grid"><i class="fa fa-check"></i><b>6.7</b> Función <code>grid</code>  </a></li>
<li class="chapter" data-level="6.8" data-path="auxiliares.html"><a href="auxiliares.html#funcion-points"><i class="fa fa-check"></i><b>6.8</b> Función <code>points</code>  </a></li>
<li class="chapter" data-level="6.9" data-path="auxiliares.html"><a href="auxiliares.html#funcion-curve"><i class="fa fa-check"></i><b>6.9</b> Función <code>curve</code>  </a><ul>
<li class="chapter" data-level="" data-path="auxiliares.html"><a href="auxiliares.html#ejemplo-41"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="auxiliares.html"><a href="auxiliares.html#ejemplo-42"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="auxiliares.html"><a href="auxiliares.html#ejercicios-1"><i class="fa fa-check"></i>EJERCICIOS</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="respuestas.html"><a href="respuestas.html"><i class="fa fa-check"></i><b>7</b> Respuestas a preguntas frecuentes</a><ul>
<li class="chapter" data-level="7.1" data-path="respuestas.html"><a href="respuestas.html#como-crear-un-grafico-vacio"><i class="fa fa-check"></i><b>7.1</b> ¿Cómo crear un gráfico vacío? </a></li>
<li class="chapter" data-level="7.2" data-path="respuestas.html"><a href="respuestas.html#como-personalizar-los-valores-a-mostrar-en-los-ejes"><i class="fa fa-check"></i><b>7.2</b> ¿Cómo personalizar los valores a mostrar en los ejes?</a></li>
<li class="chapter" data-level="7.3" data-path="respuestas.html"><a href="respuestas.html#como-dibujar-varios-qqplot-en-una-misma-figura"><i class="fa fa-check"></i><b>7.3</b> ¿Cómo dibujar varios QQplot en una misma figura?</a></li>
<li class="chapter" data-level="7.4" data-path="respuestas.html"><a href="respuestas.html#como-dibujar-varias-densidades-en-una-misma-figura"><i class="fa fa-check"></i><b>7.4</b> ¿Cómo dibujar varias densidades en una misma figura?</a></li>
<li class="chapter" data-level="7.5" data-path="respuestas.html"><a href="respuestas.html#como-dibujar-varias-densidades-transparentes-en-una-misma-figura"><i class="fa fa-check"></i><b>7.5</b> ¿Cómo dibujar varias densidades transparentes en una misma figura?</a></li>
<li class="chapter" data-level="7.6" data-path="respuestas.html"><a href="respuestas.html#como-incluir-una-rejilla-a-una-figura-en-ciertos-puntos"><i class="fa fa-check"></i><b>7.6</b> ¿Cómo incluir una rejilla a una figura en ciertos puntos? </a></li>
<li class="chapter" data-level="7.7" data-path="respuestas.html"><a href="respuestas.html#como-incluir-en-un-grafico-valores-en-forma-automatica"><i class="fa fa-check"></i><b>7.7</b> ¿Cómo incluir en un gráfico valores en forma automática?</a></li>
<li class="chapter" data-level="7.8" data-path="respuestas.html"><a href="respuestas.html#como-incluir-en-un-grafico-varios-valores-en-forma-automatica"><i class="fa fa-check"></i><b>7.8</b> ¿Cómo incluir en un gráfico varios valores en forma automática?</a></li>
<li class="chapter" data-level="7.9" data-path="respuestas.html"><a href="respuestas.html#como-incluir-colores-dependiendo-de-los-valores-de-una-variable-cualitativa"><i class="fa fa-check"></i><b>7.9</b> ¿Cómo incluir colores dependiendo de los valores de una variable cualitativa?</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="extras.html"><a href="extras.html"><i class="fa fa-check"></i><b>8</b> Extras</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Gráficos con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="doscuanti" class="section level1">
<h1><span class="header-section-number">3</span> Gráficos para varias variables cuantitativas</h1>
<p>En este capítulo se presentan funciones para la creación de gráficos que involucran varias variables cuantitativas.</p>
<div id="funcion-plot" class="section level2">
<h2><span class="header-section-number">3.1</span> Función <code>plot</code>  </h2>
<p>Los gráficos de dispersión son muy útiles porque permiten ver la relación que existe entre dos variables cuantitativas, la función <code>plot</code> permite crear este tipo de gráficos. La estructura de la función <code>plot</code> con los argumentos más usuales se muestra a continuación:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(x, y, type, main, sub, xlab, ylab)</code></pre>
<p>Los argumentos de la función <code>plot</code> son:</p>
<ul>
<li><code>x</code>: vector numérico con las coordenadas del eje horizontal.</li>
<li><code>y</code>: vector numérico con las coordenadas del eje vertical.</li>
<li><code>type</code>: tipo de gráfico a dibujar. Las opciones son: 
<ul>
<li><code>'p'</code> para obtener puntos, esta es la opción por defecto.</li>
<li><code>'l'</code> para obtener líneas.</li>
<li><code>'b'</code> para obtener los puntos y líneas que unen los puntos.</li>
<li><code>'c'</code> para obtener sólo las líneas y dejando los espacios donde estaban los puntos obtenidos con la opción <code>'b'</code>.</li>
<li><code>'o'</code> para obtener los puntos y lineas superpuestas.</li>
<li><code>'h'</code> para obtener líneas verticales desde el origen hasta el valor <span class="math inline">\(y_i\)</span> de cada punto, similar a un histograma.</li>
<li><code>'s'</code> para obtener escalones.</li>
<li><code>'S'</code> similar al anterior.</li>
<li><code>'n'</code> para que no dibuje.</li>
</ul></li>
<li><code>...</code>: otros parámetros gráficos que pueden ser pasados como argumentos para <code>plot</code>.</li>
</ul>
<div id="ejemplo-9" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Crear 16 parejas de puntos tales que <span class="math inline">\(x=-5, -4, \ldots, 9, 10\)</span> con <span class="math inline">\(y=-10+(x-3)^2\)</span>, dibujar los nueve diagramas de dispersión de <span class="math inline">\(y\)</span> contra <span class="math inline">\(x\)</span> usando todos los valores posibles para el parámetro <code>type</code>.</p>
<p>A continuación se muestra el código para crear las 16 parejas de <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span>. Los nueve diagramas de dispersión se observan en la Figura <a href="doscuanti.html#fig:ex1plot">3.1</a>, de esta figura se observa claramente el efecto que tiene el parámetro <code>type</code> en la construcción del diagrama de dispersión.</p>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">-5</span><span class="op">:</span><span class="dv">10</span>
y &lt;-<span class="st"> </span><span class="dv">-10</span> <span class="op">+</span><span class="st"> </span>(x<span class="dv">-3</span>)<span class="op">^</span><span class="dv">2</span>
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>))
<span class="kw">plot</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">type=</span><span class="st">&#39;p&#39;</span>, <span class="dt">main=</span><span class="st">&quot;con type=&#39;p&#39;&quot;</span>)
<span class="kw">plot</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">main=</span><span class="st">&quot;con type=&#39;l&#39;&quot;</span>)
<span class="kw">plot</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">type=</span><span class="st">&#39;b&#39;</span>, <span class="dt">main=</span><span class="st">&quot;con type=&#39;b&#39;&quot;</span>)
<span class="kw">plot</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">type=</span><span class="st">&#39;c&#39;</span>, <span class="dt">main=</span><span class="st">&quot;con type=&#39;c&#39;&quot;</span>)
<span class="kw">plot</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">type=</span><span class="st">&#39;o&#39;</span>, <span class="dt">main=</span><span class="st">&quot;con type=&#39;o&#39;&quot;</span>)
<span class="kw">plot</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">type=</span><span class="st">&#39;h&#39;</span>, <span class="dt">main=</span><span class="st">&quot;con type=&#39;h&#39;&quot;</span>)
<span class="kw">plot</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">type=</span><span class="st">&#39;s&#39;</span>, <span class="dt">main=</span><span class="st">&quot;con type=&#39;s&#39;&quot;</span>)
<span class="kw">plot</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">type=</span><span class="st">&#39;S&#39;</span>, <span class="dt">main=</span><span class="st">&quot;con type=&#39;S&#39;&quot;</span>)
<span class="kw">plot</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">type=</span><span class="st">&#39;n&#39;</span>, <span class="dt">main=</span><span class="st">&quot;con type=&#39;n&#39;&quot;</span>)</code></pre>
<div class="figure"><span id="fig:ex1plot"></span>
<img src="Graficos_con_R_files/figure-html/ex1plot-1.png" alt="Efecto del parámetro `type` en la función `plot`." width="480" />
<p class="caption">
Figure 3.1: Efecto del parámetro <code>type</code> en la función <code>plot</code>.
</p>
</div>

</div>
<div id="ejemplo-10" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Como ilustración vamos a crear dos diagramas de dispersión entre el precio de apartamentos usados en la ciudad de Medellín y el área de los apartamentos. El primer diagrama es un gráfico básico mientras que el segundo es un diagrama mejorado.</p>
<p>El código necesario para cargar la base de datos y construir los diagramas de dispersión se muestra a continuación.</p>
<pre class="sourceCode r"><code class="sourceCode r">url &lt;-<span class="st"> &#39;https://tinyurl.com/hwhb769&#39;</span>
datos &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">file=</span>url, <span class="dt">header=</span>T)

<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">plot</span>(<span class="dt">x=</span>datos<span class="op">$</span>mt2, <span class="dt">y=</span>datos<span class="op">$</span>precio)
<span class="kw">plot</span>(<span class="dt">x=</span>datos<span class="op">$</span>mt2, <span class="dt">y=</span>datos<span class="op">$</span>precio, <span class="dt">pch=</span><span class="st">&#39;.&#39;</span>,
     <span class="dt">xlab=</span><span class="st">&#39;Área del apartamento (m2)&#39;</span>,
     <span class="dt">ylab=</span><span class="st">&#39;Precio (millones de pesos)&#39;</span>)</code></pre>
<div class="figure"><span id="fig:ex2plot"></span>
<img src="Graficos_con_R_files/figure-html/ex2plot-1.png" alt="Diagrama de dispersión del precio del apartamento versus área del apartamento. A la izquierda el diagrama de dispersión sin editar y a la derecha el diagrama de dispersión mejorado." width="768" />
<p class="caption">
Figure 3.2: Diagrama de dispersión del precio del apartamento versus área del apartamento. A la izquierda el diagrama de dispersión sin editar y a la derecha el diagrama de dispersión mejorado.
</p>
</div>
<p>En la Figura <a href="doscuanti.html#fig:ex2plot">3.2</a> se presentan los diagramas de dispersión entre precio y área de los apartamentos. En el panel de la izquierda está el diagrama básico, de este diagrama se observa claramente que a medida que los apartamentos tienen mayor área el precio promedio y la variabilidad del precio aumentan. En la parte inferior izquierda de este diagrama se tiene una zona de alta densidad de puntos y por esa razón se observa una mancha en el diagrama. Para la construcción del diagrama de dispersión mostrado en el panel derecho se usó el parámetro <code>pch='.'</code> con el objetivo de obtener pequeños puntos que representen cada apartamento y que no se traslapen debido a que se tienen 694 observaciones en la base de datos.</p>
</div>
</div>
<div id="funcion-sunflowerplot" class="section level2">
<h2><span class="header-section-number">3.2</span> Función <code>sunflowerplot</code> </h2>
<p>La función <code>sunflowerplot</code> sirve para crear gráficos de dispersión en los cuales hay parejas repetidas que se superponen y que por lo tanto no se podrían apreciar.</p>
<p>Si una pareja está una sola vez se representará por un punto; si la pareja se repite dos veces se representará por un punto y dos rayitas rojas (pétalos); si la pareja se repite tres veces se representará por un punto y tres rayitas rojas (pétalos) y así sucesivamente.</p>
<p>La estructura de la función <code>sunflowerplot</code> con los argumentos más usuales se muestra a continuación:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sunflowerplot</span>(x, y, pch, seg.col, seg.lwd, ...)</code></pre>
<p>Los argumentos de la función <code>plot</code> son:</p>
<ul>
<li><code>x</code>: vector numérico con las coordenadas del eje horizontal.</li>
<li><code>y</code>: vector numérico con las coordenadas del eje vertical.</li>
<li><code>pch</code>: valor o vector numérico con el tipo de punto a usar, por defecto <code>pch=1</code>. Para conocer los diferentes símbolos que se pueden obtener con el parámetro <code>pch</code> se recomienda consultar la Figura <a href="auxiliares.html#fig:point1">6.11</a>.</li>
<li><code>seg.col</code>: color de los pétalos.</li>
<li><code>seg.lwd</code>: ancho de los pétalos.</li>
<li><code>...</code>: otros parámetros gráficos que pueden ser pasados como argumentos para <code>plot</code>.</li>
</ul>
<p>A continuación se presenta un ejemplo en los cuales se usa la función <code>sunflowerplot</code> para crear gráficos de dispersión.</p>
<div id="ejemplo-11" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Suponga que se tiene el punto (1, 1) una sola vez, el punto (2, 3) repetido cuatro veces, el punto (3, 2) repetido seis veces y el punto (4, 5) repetido dos veces. El objetivo es crear dos gráficos de dispersión con los trece puntos, uno con la función <code>plot</code> y el otro con la función <code>sunflowerplot</code> para comparar los resultados.</p>
<p>A continuación se muestra el código con la creación de los vectores y los dos gráficos de dispersión con <code>plot</code> y <code>sunflowerplot</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>)
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">5</span>)

<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">plot</span>(x, y, <span class="dt">main=</span><span class="st">&#39;a) Usando plot&#39;</span>)
<span class="kw">sunflowerplot</span>(x, y, <span class="dt">seg.col=</span><span class="st">&#39;blue&#39;</span>, <span class="dt">seg.lwd=</span><span class="dv">2</span>, <span class="dt">cex=</span><span class="fl">1.5</span>,
              <span class="dt">main=</span><span class="st">&#39;b) Usando sunflowerplot&#39;</span>)</code></pre>
<div class="figure"><span id="fig:sunflower1"></span>
<img src="Graficos_con_R_files/figure-html/sunflower1-1.png" alt="Gráfico de dispersión para datos hipotéticos. En la izquierda el gráfico obtenido con `plot` y a la derecha el obtenido con `sunflowerplot`." width="768" />
<p class="caption">
Figure 3.3: Gráfico de dispersión para datos hipotéticos. En la izquierda el gráfico obtenido con <code>plot</code> y a la derecha el obtenido con <code>sunflowerplot</code>.
</p>
</div>
<p>En la Figura <a href="doscuanti.html#fig:sunflower1">3.3</a> se muestran los dos gráficos de dispersión para los datos. En el panel de la izquierda está el diagrama obtenido con la función <code>plot</code> pero sólo se observan 4 puntos cuando en realidad eran 13, esto se debe a que hay puntos repetidos y éstos quedan unos sobre otros. En el panel de la derecha está el diagrama obtenido con la función <code>sunflowerplot</code>, en este diagrama se observan cuatro objetos: el punto con coordenadas (1, 1) se representó con un punto ya que él no se repite, el punto (2, 3) está representado por un punto y cuatro pétalos de color azul ya que él se repite cuatro veces, y los puntos (3, 2) y (4, 5) se represetan con seis y dos pétalos porque esas son las veces que ellos se repiten.</p>
</div>
<div id="ejemplo-12" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Como ilustración vamos a crear un diagrama de dispersión con la función <code>sunflowerplot</code> para las variables número de alcobas y número de baños de la base de datos de apartamentos usados.</p>
<p>El código necesario para cargar la base de datos y construir el diagrama de dispersión se muestra a continuación. El diagrama de dispersión se construyó excluyendo la información del apartamento 594 porque éste aparece con 14 alcobas.</p>
<pre class="sourceCode r"><code class="sourceCode r">url &lt;-<span class="st"> &#39;https://tinyurl.com/hwhb769&#39;</span>
datos &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">file=</span>url, <span class="dt">header=</span>T)
datos &lt;-<span class="st"> </span>datos[<span class="op">-</span><span class="dv">594</span>, ]  <span class="co"># Sacando el apto 594</span>
<span class="kw">sunflowerplot</span>(<span class="dt">x=</span>datos<span class="op">$</span>alcobas, <span class="dt">y=</span>datos<span class="op">$</span>banos)</code></pre>
<div class="figure"><span id="fig:sunflower2"></span>
<img src="Graficos_con_R_files/figure-html/sunflower2-1.png" alt="Diagrama de dispersión para número de baños versus número de alcobas." width="336" />
<p class="caption">
Figure 3.4: Diagrama de dispersión para número de baños versus número de alcobas.
</p>
</div>
<p>En la Figura <a href="doscuanti.html#fig:sunflower2">3.4</a> se muestra el diagrama de dispersión entre número de baños y número de alcobas. De este diagrama se observa que la mayor parte de los apartamentos de la base de datos tienen 2 o 3 alcobas con 2 o 3 baños, se nota que sólo 8 apartamentos tiene 5 alcobas y que sólo un apatamento tiene seis baños.</p>
</div>
</div>
<div id="funcion-symbols" class="section level2">
<h2><span class="header-section-number">3.3</span> Función <code>symbols</code> </h2>
<p>La función <code>symbols</code> sirve para construir diagramas de dispersión en dos dimensiones incluyendo información adicional de variables cuantitativas.</p>
<div id="ejemplo-13" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Como ilustración vamos a crear un diagrama de dispersión entre el precio de apartamentos usados en la ciudad de Medellín y el área de los apartamentos pero incluyendo otras variables.</p>
<pre class="sourceCode r"><code class="sourceCode r">url &lt;-<span class="st"> &#39;https://tinyurl.com/hwhb769&#39;</span>
datos &lt;-<span class="st"> </span><span class="kw">read.table</span>(url, <span class="dt">header=</span>T)
subdat &lt;-<span class="st"> </span><span class="kw">subset</span>(datos, ubicacion <span class="op">==</span><span class="st"> &#39;centro&#39;</span>)

<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">with</span>(subdat, <span class="kw">symbols</span>(<span class="dt">x=</span>mt2, <span class="dt">y=</span>precio,
                     <span class="dt">circles=</span>alcobas, 
                     <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">inches=</span><span class="fl">0.4</span>, 
                     <span class="dt">fg=</span><span class="st">&#39;red&#39;</span>,
                     <span class="dt">main=</span><span class="st">&#39;Radio = N° alcobas&#39;</span>))

<span class="kw">with</span>(subdat, <span class="kw">symbols</span>(<span class="dt">x=</span>mt2, <span class="dt">y=</span>precio,
                     <span class="dt">squares=</span>alcobas, 
                     <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">inches=</span><span class="fl">0.4</span>, 
                     <span class="dt">fg=</span><span class="st">&#39;dodgerblue4&#39;</span>, <span class="dt">bg=</span><span class="st">&#39;pink&#39;</span>,
                     <span class="dt">main=</span><span class="st">&#39;Lado = N° alcobas&#39;</span>))</code></pre>
<div class="figure"><span id="fig:symbols1"></span>
<img src="Graficos_con_R_files/figure-html/symbols1-1.png" alt="Diagrama de dispersión con los símbolos circle y squares para incluir más variables." width="768" />
<p class="caption">
Figure 3.5: Diagrama de dispersión con los símbolos circle y squares para incluir más variables.
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">with</span>(subdat, <span class="kw">symbols</span>(<span class="dt">x=</span>mt2, <span class="dt">y=</span>precio,
                     <span class="dt">rectangles=</span><span class="kw">cbind</span>(estrato, alcobas), 
                     <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">inches=</span><span class="fl">0.4</span>, 
                     <span class="dt">fg=</span><span class="st">&#39;chartreuse4&#39;</span>, <span class="dt">bg=</span><span class="st">&#39;yellow&#39;</span>,
                     <span class="dt">main=</span><span class="st">&#39;Ancho = estrato y Alto = N° alcobas&#39;</span>))

<span class="kw">with</span>(subdat, <span class="kw">symbols</span>(<span class="dt">x=</span>mt2, <span class="dt">y=</span>precio,
                     <span class="dt">stars=</span><span class="kw">cbind</span>(estrato, alcobas,
                                 banos), 
                     <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">inches=</span><span class="fl">0.4</span>, 
                     <span class="dt">fg=</span><span class="st">&#39;purple1&#39;</span>, <span class="dt">bg=</span><span class="st">&#39;tomato&#39;</span>,
                     <span class="dt">main=</span><span class="st">&#39;Estrato, alcobas y n° baños&#39;</span>))</code></pre>
<div class="figure"><span id="fig:symbols2"></span>
<img src="Graficos_con_R_files/figure-html/symbols2-1.png" alt="Diagrama de dispersión con los símbolos rectangles y stars para incluir más variables." width="768" />
<p class="caption">
Figure 3.6: Diagrama de dispersión con los símbolos rectangles y stars para incluir más variables.
</p>
</div>
</div>
</div>
<div id="funcion-pairs" class="section level2">
<h2><span class="header-section-number">3.4</span> Función <code>pairs</code> </h2>
<p>Las matrices de dispersión obtenidas con la función <code>pairs</code> proporcionan un método simple de presentar las relaciones entre pares de variables cuantitativas y son la versión múltiple de la función <code>plot</code>. Este gráfico consiste en una matriz donde cada entrada presenta un gráfico de dispersión sencillo. Un inconveniente es que si tenemos muchas variables el tamaño de cada entrada se reduce demasiado impidiendo ver con claridad las relaciones entre los pares de variables. La celda <span class="math inline">\((i,j)\)</span> de una matriz de dispersión contiene el gráfico de dispersión de la columna <span class="math inline">\(i\)</span> versus la columna <span class="math inline">\(j\)</span> de la matriz de datos.</p>
<p>En la Figura <a href="doscuanti.html#fig:ex0pairs">3.7</a> se muestra un ejemplo de una matriz de dispersión para un conjunto de datos, en la diagonal están los nombres de las variables y por fuera de la diagonal están los diagramas de dispersión para cada combinación de variables.</p>
<div class="figure"><span id="fig:ex0pairs"></span>
<img src="Graficos_con_R_files/figure-html/ex0pairs-1.png" alt="Ilustración de una matriz de dispersión." width="576" />
<p class="caption">
Figure 3.7: Ilustración de una matriz de dispersión.
</p>
</div>
<p>La estructura de la función <code>pairs</code> con los argumentos más usuales se muestra a continuación:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairs</span>(x, labels, <span class="dt">panel =</span> points, ...,
      <span class="dt">horInd =</span> <span class="dv">1</span><span class="op">:</span>nc, <span class="dt">verInd =</span> <span class="dv">1</span><span class="op">:</span>nc,
      <span class="dt">lower.panel =</span> panel, <span class="dt">upper.panel =</span> panel,
      <span class="dt">diag.panel =</span> <span class="ot">NULL</span>, <span class="dt">text.panel =</span> textPanel,
      <span class="dt">label.pos =</span> <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>has.diag<span class="op">/</span><span class="dv">3</span>, <span class="dt">line.main =</span> <span class="dv">3</span>,
      <span class="dt">cex.labels =</span> <span class="ot">NULL</span>, <span class="dt">font.labels =</span> <span class="dv">1</span>,
      <span class="dt">row1attop =</span> <span class="ot">TRUE</span>, <span class="dt">gap =</span> <span class="dv">1</span>, <span class="dt">log =</span> <span class="st">&quot;&quot;</span>)</code></pre>
<p>Los argumentos de la función <code>pairs</code> son:</p>
<ul>
<li><code>x</code>: matriz o marco de datos con la información de las variables cuantitativas a incluir en la matriz de dispersión.</li>
<li><code>labels</code>: vector opcional con los nombres a colocar en la diagonal, por defecto se usan los nombres de columnas del objeto <code>x</code>.</li>
<li><code>panel</code>: función usual de la forma <code>function(x,y,...)</code> a ser usada para determinar el contenido de los páneles. Por defecto es <code>points</code>, indicando que se graficarán los puntos de los pares de variables. Es posible utilizar aquí otras funciones diseñadas por el usuario.</li>
<li><code>...</code>: Indica que es posible agregar otros parámetros gráficos, tales como <code>pch</code> y <code>col</code>, con los cuales puede especificarse un vector de símbolos y colores a ser usados en los scatterplots.</li>
<li><code>lower.panel, upper.panel</code>: función usual de la forma <code>function(x,y,...)</code> para definir lo que se desea dibujar en los paneles abajo y arriba de la diagonal.</li>
<li><code>diag.panel</code>: función usual de la forma <code>function(x,y,...)</code> para definir lo que se desea dibujar en la diagonal.</li>
<li><code>text.panel</code>: Es opcional. Permite que una función: <code>function(x, y, labels, cex, font, ...)</code> sea aplicada a los paneles de la diagonal.</li>
<li><code>label.pos</code>: Para especificar la posición <span class="math inline">\(y\)</span> de las etiquetas en el text panel.</li>
<li><code>cex.labels, font.labels</code>: Parámetros para la expansión de caracteres y fuentes a usar en las etiquetas de las variables.</li>
<li><code>row1attop</code>: Parámetro lógico con el cual se especifica si el gráfico para especificar si el diseño lucirá como una matriz con su primera fila en la parte superior o como un gráfico con fila uno en la base. Por defecto es lo primero.</li>
</ul>
<div id="ejemplo-14" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Dibujar una matriz de dispersión para las variables precio, área, número de alcobas y número de baños de la base de datos sobre apartamentos en Medellín.</p>
<p>A continuación se muestra el código usado para crear el gráfico solicitado. El objeto <code>datos</code> corresponde a la base de datos completa mientras que <code>datos.num</code> es el marco de datos sólo con las variables de interés precio, área, número de alcobas y número de baños.</p>
<pre class="sourceCode r"><code class="sourceCode r">url &lt;-<span class="st"> &#39;https://tinyurl.com/hwhb769&#39;</span>
datos &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">file=</span>url, <span class="dt">header=</span>T)
datos.num &lt;-<span class="st"> </span>datos[, <span class="kw">c</span>(<span class="st">&#39;precio&#39;</span>, <span class="st">&#39;mt2&#39;</span>, <span class="st">&#39;alcobas&#39;</span>, <span class="st">&#39;banos&#39;</span>)]

<span class="kw">pairs</span>(datos.num)</code></pre>
<div class="figure"><span id="fig:ex1pairs"></span>
<img src="Graficos_con_R_files/figure-html/ex1pairs-1.png" alt="Matriz de dispersión para las variables precio, área, número de alcobas y número de baños de la base de datos sobre apartamentos en Medellín." width="576" />
<p class="caption">
Figure 3.8: Matriz de dispersión para las variables precio, área, número de alcobas y número de baños de la base de datos sobre apartamentos en Medellín.
</p>
</div>
<p>En la Figura <a href="doscuanti.html#fig:ex1pairs">3.8</a> se muestra la matriz de dispersión para las variables del marco de datos <code>datos.num</code>.</p>
</div>
<div id="ejemplo-15" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Volver a construir la Figura <a href="doscuanti.html#fig:ex1pairs">3.8</a> editando los nombres de las variables, usando cruces azules en lugar de puntos, en escala logaritmica, con marcas horizontales en el eje vertical y eliminando los diagramas de dispersión abajo de la diagonal.</p>
<p>Para obtener la nueva matriz de dispersión con los cambios solicitados se usa el siguiente código. En la Figura <a href="doscuanti.html#fig:ex2pairs">3.9</a> se presenta la nueva matriz de dispersión.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairs</span>(datos.num, <span class="dt">lower.panel=</span><span class="ot">NULL</span>, <span class="dt">cex.labels=</span><span class="fl">1.5</span>, <span class="dt">log=</span><span class="st">&#39;xy&#39;</span>,
      <span class="dt">main=</span><span class="st">&#39;Matriz de dispersión&#39;, las=1,</span>
<span class="st">      labels=c(&#39;</span>Precio<span class="st">&#39;, &#39;</span>Área<span class="st">&#39;, &#39;</span>Num alcobas<span class="st">&#39;, &#39;</span>Num baños<span class="st">&#39;),</span>
<span class="st">      pch=3, cex=0.6, col=&#39;</span>dodgerblue2<span class="st">&#39;)</span></code></pre>
<div class="figure"><span id="fig:ex2pairs"></span>
<img src="Graficos_con_R_files/figure-html/ex2pairs-1.png" alt="Matriz de dispersión modificando los parámetros adicionales de la función `pairs`." width="576" />
<p class="caption">
Figure 3.9: Matriz de dispersión modificando los parámetros adicionales de la función <code>pairs</code>.
</p>
</div>
</div>
<div id="ejemplo-16" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Construir una matriz de dispersión con las variables precio, área y avaluo para apartamentos que cumplan la condición <span class="math inline">\(100 m^2 &lt; area &lt; 130 m^2\)</span>. Adicionalmente, se deben diferenciar los apartamentos sin parqueadero con color rojo y los apartamentos con parqueadero con color verde.</p>
<p>Para crear una matriz de dispersión se puede tambien usar la base de datos original llamada <code>datos</code> que contiene todas las variables y usar una fórmula con la ayuda del operador <code>~</code> para indicar las variables de interés. La fórmula <strong>NO</strong> debe contener nada del lado izquierdo mientras que en el lado derecho se colocan todas las variables a considerar en la matriz de dispersión, por esta razón es que en el códido mostrado abajo se inicia con la instrucción <code>~ precio + mt2 + avaluo</code>. Para incluir condiciones se usa el parámetro <code>subset</code> de la siguiente manera: <code>subset=mt2 &gt; 100 &amp; mt2 &lt; 130</code>. A continuación el código completo para construir la matriz de dispersión solicitada.</p>
<pre class="sourceCode r"><code class="sourceCode r">col1 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(datos<span class="op">$</span>parqueadero <span class="op">==</span><span class="st"> &#39;no&#39;</span>, <span class="st">&#39;red&#39;</span>, <span class="st">&#39;green3&#39;</span>)
<span class="kw">pairs</span>(<span class="op">~</span><span class="st"> </span>precio <span class="op">+</span><span class="st"> </span>mt2 <span class="op">+</span><span class="st"> </span>avaluo, <span class="dt">data=</span>datos,
      <span class="dt">lower.panel=</span><span class="ot">NULL</span>, <span class="dt">col=</span>col1,
      <span class="dt">subset=</span>mt2 <span class="op">&gt;</span><span class="st"> </span><span class="dv">100</span> <span class="op">&amp;</span><span class="st"> </span>mt2 <span class="op">&lt;</span><span class="st"> </span><span class="dv">130</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span><span class="fl">0.8</span>,
      <span class="dt">main=</span><span class="st">&quot;Matriz de dispersión para aptos con </span>
<span class="st">      100 &lt; área &lt; 130 mt2&quot;</span>)</code></pre>
<div class="figure"><span id="fig:ex3pairs"></span>
<img src="Graficos_con_R_files/figure-html/ex3pairs-1.png" alt="Matriz de dispersión con un subconjunto de los datos y con colores para identificar los puntos." width="576" />
<p class="caption">
Figure 3.10: Matriz de dispersión con un subconjunto de los datos y con colores para identificar los puntos.
</p>
</div>
<p>En la Figura <a href="doscuanti.html#fig:ex3pairs">3.10</a> se presenta la matriz de dispersión solicitada, los puntos rojos representan los apartamento sin parqueadero mientras que los puntos verdes son los apartamento que si tienen parqueadero.</p>
</div>
<div id="ejemplo-17" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>¿Es posible agregar una leyenda a una matriz de dispersión?</p>
<p>Claro que es posible, se construye la matriz de dispersión y se deja en el lienzo del dibujo un espacio para colocar la leyenda. A continuación se muestra un ejemplo disponible en <a href="http://stackoverflow.com/questions/14948852/how-to-use-the-pairs-function-combined-with-layout-in-r">Stackoverflow</a>. A continuación se muestra el código para el ejemplo y en la Figura <a href="doscuanti.html#fig:expairs">3.11</a> se presenta el resultado.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairs</span>(iris[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">main=</span><span class="st">&quot;Anderson&#39;s Iris Data -- 3 species&quot;</span>,
      <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green3&quot;</span>, <span class="st">&quot;blue&quot;</span>)[iris<span class="op">$</span>Species],
      <span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">12</span>))
<span class="kw">par</span>(<span class="dt">xpd=</span><span class="ot">TRUE</span>)
<span class="kw">legend</span>(<span class="fl">0.85</span>, <span class="fl">0.7</span>, <span class="kw">as.vector</span>(<span class="kw">unique</span>(iris<span class="op">$</span>Species)), <span class="dt">bty=</span><span class="st">&#39;n&#39;</span>,
       <span class="dt">fill=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green3&quot;</span>, <span class="st">&quot;blue&quot;</span>))</code></pre>
<div class="figure"><span id="fig:expairs"></span>
<img src="Graficos_con_R_files/figure-html/expairs-1.png" alt="Matriz de dispersión con leyenda." width="576" />
<p class="caption">
Figure 3.11: Matriz de dispersión con leyenda.
</p>
</div>
</div>
<div id="ejemplo-18" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>¿Es posible modificar el contenido de los páneles de una matriz de dispersión?</p>
<p>Claro que es posible, para hacer esto se definen funciones que hagan lo que se desea ver tanto en la diagonal como arriba y abajo de la misma.</p>
<p>Como ejemplo vamos a construir una matriz de dispersión que cumpla:</p>
<ul>
<li>sobre la diagonal un diagrama de dispersión para las variables involucradas y la recta de regresión ajustada,</li>
<li>en la diagonal un histograma para la variable,</li>
<li>debajo de la diagonal el coeficiente de correlación entre las variables involucradas y usando un tamaño de fuente proporcional a la fuerza de correlación.</li>
</ul>
<p>Para obtener esta matriz de dispersión especial se definen a continuación las funciones <code>panel.reg</code>, <code>panel.hist</code> y <code>panel.cor</code>, a continuación el código utilizado. Luego se usa la función <code>pairs</code> y se indica qué función debe actuar en cada uno de los parámetros <code>upper.panel</code>, <code>diag.panel</code> y <code>lower.panel</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Función para dibujar los puntos y agregar la recta de regresión</span>
panel.reg &lt;-<span class="st"> </span><span class="cf">function</span> (x, y) 
{
  <span class="kw">points</span>(x, y, <span class="dt">pch=</span><span class="dv">20</span>)
  <span class="kw">abline</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x), <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&#39;dodgerblue2&#39;</span>)
}

<span class="co"># Función para crear el histograma</span>
panel.hist &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...)
{
  usr &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>); <span class="kw">on.exit</span>(<span class="kw">par</span>(usr))
  <span class="kw">par</span>(<span class="dt">usr =</span> <span class="kw">c</span>(usr[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">0</span>, <span class="fl">1.5</span>) )
  h &lt;-<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">plot =</span> <span class="ot">FALSE</span>)
  breaks &lt;-<span class="st"> </span>h<span class="op">$</span>breaks; nB &lt;-<span class="st"> </span><span class="kw">length</span>(breaks)
  y &lt;-<span class="st"> </span>h<span class="op">$</span>counts; y &lt;-<span class="st"> </span>y<span class="op">/</span><span class="kw">max</span>(y)
  <span class="kw">rect</span>(breaks[<span class="op">-</span>nB], <span class="dv">0</span>, breaks[<span class="op">-</span><span class="dv">1</span>], y, <span class="dt">col=</span><span class="st">&quot;dodgerblue2&quot;</span>, ...)
}

<span class="co"># Función para obtener la correlación</span>
panel.cor &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, <span class="dt">digits=</span><span class="dv">2</span>, <span class="dt">prefix=</span><span class="st">&quot;&quot;</span>, cex.cor)
{
  usr &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>); <span class="kw">on.exit</span>(<span class="kw">par</span>(usr))
  <span class="kw">par</span>(<span class="dt">usr =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))
  r &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">cor</span>(x, y))
  txt &lt;-<span class="st"> </span><span class="kw">format</span>(<span class="kw">c</span>(r, <span class="fl">0.123456789</span>), <span class="dt">digits=</span>digits)[<span class="dv">1</span>]
  txt &lt;-<span class="st"> </span><span class="kw">paste</span>(prefix, txt, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)
  <span class="cf">if</span>(<span class="kw">missing</span>(cex.cor)) cex &lt;-<span class="st"> </span><span class="fl">0.8</span><span class="op">/</span><span class="kw">strwidth</span>(txt)
  <span class="kw">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="dt">cex =</span> cex <span class="op">*</span><span class="st"> </span>r)
}

<span class="kw">pairs</span>(datos.num,
      <span class="dt">upper.panel =</span> panel.reg,
      <span class="dt">diag.panel =</span> panel.hist,
      <span class="dt">lower.panel =</span> panel.cor)</code></pre>
<div class="figure"><span id="fig:exmod1pairs"></span>
<img src="Graficos_con_R_files/figure-html/exmod1pairs-1.png" alt="Matriz de dispersión con páneles modificados." width="576" />
<p class="caption">
Figure 3.12: Matriz de dispersión con páneles modificados.
</p>
</div>
<p>En la Figura <a href="doscuanti.html#fig:exmod1pairs">3.12</a> se presenta la matriz de dispersión con las modificaciones en cada uno de los páneles. Cualquier usuario puede modificar las funciones <code>panel.reg</code>, <code>panel.hist</code> y <code>panel.cor</code> para personalizar la apariencia de los contenidos.</p>
<p>La función <code>panel.smooth</code> está disponible en  para que el usuario pueda incluir arriba o abajo de la diagonal un diagrama de dispersión con una línea resultado de un ajuste suavizado. Abajo se muestra el código de cómo incluir la función <code>panel.smooth</code> y en la Figura <a href="doscuanti.html#fig:exmod2pairs">3.13</a> se muestra gráfico obtenido.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairs</span>(datos.num,
      <span class="dt">upper.panel =</span> panel.reg,
      <span class="dt">diag.panel =</span> panel.hist,
      <span class="dt">lower.panel =</span> panel.smooth)</code></pre>
<div class="figure"><span id="fig:exmod2pairs"></span>
<img src="Graficos_con_R_files/figure-html/exmod2pairs-1.png" alt="Matriz de dispersión usando la función panel.smooth." width="576" />
<p class="caption">
Figure 3.13: Matriz de dispersión usando la función panel.smooth.
</p>
</div>

<div class="rmdtip">
Al construir un gráfico con <code>pairs</code> se recomienda no incluir demasiadas variables porque el gráfico se satura y no se pueden apreciar los patrones con facilidad. Se recomienda máximo 10 variables.
</div>

</div>
</div>
<div id="funcion-persp" class="section level2">
<h2><span class="header-section-number">3.5</span> Función <code>persp</code> </h2>
<p>La función <code>persp</code> dibuja superfices en tres dimensiones y es posible rotar la superficie para obtener una perpectiva apropiada. La estructura de la función <code>persp</code> con los argumentos más usuales se muestra a continuación:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">persp</span>(x, y, z, main, sub, theta, phi, r, col,
      border, box, axes, nticks)</code></pre>
<p>Los argumentos de la función <code>plot</code> son:</p>
<ul>
<li><code>x</code>: vector numérico con los valores de <span class="math inline">\(x\)</span> donde fue evaluada la función o superficie.</li>
<li><code>y</code>: vector numérico con los valores de <span class="math inline">\(y\)</span> donde fue evaluada la función o superficie.</li>
<li><code>z</code>: matriz que contiene las alturas <span class="math inline">\(z\)</span> de la supercifie para cada combinación de <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span>.</li>
<li><code>main</code>: vector numérico con las coordenadas del eje vertical.</li>
<li><code>sub</code>: vector numérico con las coordenadas del eje vertical.</li>
<li><code>theta, phi</code>: ángulo para la visión de la superficie, <code>theta</code> para la dirección azimutal y <code>phi</code> para latitud. Ver Figura <a href="doscuanti.html#fig:globo">3.14</a> para una ilustración de los ángulos.</li>
<li><code>r</code>: distancia entre el centro de la caja de dibujo al punto de vista.</li>
<li><code>col</code>: color de la superficie.</li>
<li><code>border</code>: color para el borde de la superficie.</li>
<li><code>box</code>: valor lógico para indicar si se quiere dibujar la caja que contiene la superficie, por defecto es <code>TRUE</code>.</li>
<li><code>axes</code>: valor lógico para indicar si se desean marcas en los ejes y nombres de los ejes, por defecto es <code>TRUE</code>. Si <code>box='FALSE'</code> no aparecen marcas ni nombres de los ejes.</li>
<li><code>expand</code>: factor de expansión aplicado a los valores en el eje <code>z</code>.</li>
<li><code>ticktype</code>: tipo de marcas a colocar en los ejes, <code>simple</code> no dibuja nada y <code>detailed</code> coloca números a los ejes.</li>
<li><code>nticks</code>: número aproximado de marcas en los ejes.</li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:globo"></span>
<img src="images/IC412528.png" alt="Ilustración de los ángulos theta y phi para la función persp. Figura tomada de https://i-msdn.sec.s-msft.com/dynimg/IC412528.png" width="40%" />
<p class="caption">
Figure 3.14: Ilustración de los ángulos theta y phi para la función persp. Figura tomada de <a href="https://i-msdn.sec.s-msft.com/dynimg/IC412528.png" class="uri">https://i-msdn.sec.s-msft.com/dynimg/IC412528.png</a>
</p>
</div>
<div id="ejemplo-19" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Dibujar la superficie asociada a la función <span class="math inline">\(f(x, y)=sen(x^2+y^2)\)</span> para <span class="math inline">\(-2 \leq x \leq2\)</span> y <span class="math inline">\(-2 \leq y \leq2\)</span>. Usar 4 combinaciones de los parámetros <code>theta</code> y <code>phi</code> para obtener un buen punto de vista de la superficie.</p>
<p>Lo primero que se debe hacer es crear la función <span class="math inline">\(f(x, y)\)</span> la cual se va a llamar <code>fun</code>. Luego se definen los vectores <code>x</code> e <code>y</code> tomando por ejemplo 25 puntos equiespaciados en el intervalo <span class="math inline">\([-2, 2]\)</span>. Luego se usa la función <code>outer</code> para crear la rejilla o matriz que contiene los valores de <span class="math inline">\(f(x, y)\)</span> para cada combinación de <code>x</code> e <code>y</code>, los resultados se almacenan en el objeto <code>z</code>. Por último se dibujan 4 perspectivas de la función variando los parámetros <code>theta</code> y <code>phi</code> de la función <code>persp</code>. A continuación el código utilizado.</p>
<pre class="sourceCode r"><code class="sourceCode r">fun &lt;-<span class="st"> </span><span class="cf">function</span>(x, y)   <span class="kw">sin</span>(x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>y<span class="op">^</span><span class="dv">2</span>)
x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="op">-</span><span class="dv">2</span>, <span class="dt">to=</span><span class="dv">2</span>, <span class="dt">length.out=</span><span class="dv">25</span>)
y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="op">-</span><span class="dv">2</span>, <span class="dt">to=</span><span class="dv">2</span>, <span class="dt">length.out=</span><span class="dv">25</span>)
z &lt;-<span class="st"> </span><span class="kw">outer</span>(x, y, fun)

<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>))
<span class="kw">persp</span>(x, y, z, <span class="dt">zlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="fl">1.5</span>), <span class="dt">theta=</span><span class="dv">0</span>, <span class="dt">phi=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">&#39;aquamarine&#39;</span>,
      <span class="dt">main=</span><span class="st">&#39;(A) theta=0, phi=0&#39;</span>)
<span class="kw">persp</span>(x, y, z, <span class="dt">zlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="fl">1.5</span>), <span class="dt">theta=</span><span class="dv">15</span>, <span class="dt">phi=</span><span class="dv">15</span>, <span class="dt">col=</span><span class="st">&#39;lightpink&#39;</span>,
      <span class="dt">main=</span><span class="st">&#39;(B) theta=15, phi=15&#39;</span>)
<span class="kw">persp</span>(x, y, z, <span class="dt">zlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="fl">1.5</span>), <span class="dt">theta=</span><span class="dv">45</span>, <span class="dt">phi=</span><span class="dv">30</span>, <span class="dt">col=</span><span class="st">&#39;yellow1&#39;</span>,
      <span class="dt">main=</span><span class="st">&#39;(c) theta=45, phi=30&#39;</span>)
<span class="kw">persp</span>(x, y, z, <span class="dt">zlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="fl">1.5</span>), <span class="dt">theta=</span><span class="dv">60</span>, <span class="dt">phi=</span><span class="dv">50</span>, <span class="dt">col=</span><span class="st">&#39;lightblue&#39;</span>,
      <span class="dt">main=</span><span class="st">&#39;(D) theta=60, phi=50&#39;</span>)</code></pre>
<div class="figure"><span id="fig:ex1persp"></span>
<img src="Graficos_con_R_files/figure-html/ex1persp-1.png" alt="Superficie generada con `persp` y diferentes valores de theta y phi." width="960" />
<p class="caption">
Figure 3.15: Superficie generada con <code>persp</code> y diferentes valores de theta y phi.
</p>
</div>
<p>En la Figura <a href="doscuanti.html#fig:ex1persp">3.15</a> se presentan las 4 perspectivas de la función <span class="math inline">\(f(x, y)=sen(x^2+y^2)\)</span>. De los 4 páneles se nota que (C) y (D) muestran mejor la superficie de interés.</p>
<p>Al aumentar el valor del parámetro <code>length.out</code> en la creación de los vectores <code>x</code> e <code>y</code> se obtendrá una rejilla más tupida, se recomienda modificar este valor para obtener una superficie apropiada.</p>
</div>
<div id="ejemplo-20" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Dibujar la superficie de una distribución normal bivariada con vector de medias <span class="math inline">\(\boldsymbol{\mu}=(5, 12)^\top\)</span>, varianzas unitarias y covarianza con valor de -0.8. Explorar el efecto de los parámetros <code>ticktype</code>, <code>nticks</code>, <code>expand</code>, <code>axes</code> y <code>box</code>.</p>
<p>Primero se define el vector de medias y la matriz de varianzas y covarianzas, luego se carga el paquete <code>mvtnorm</code> que contiene la función <code>dmvnorm</code> que calcula la densidad dado el vector de medias y la matriz de varianzas y covarianzas. Se construye la función <code>fun</code> y se vectoriza para luego obtener las alturas de la superficie con la ayuda de <code>outer</code>. Por último se dibujan tres perspectivas diferentes para la densidad modificando los parámetros <code>ticktype</code>, <code>nticks</code>, <code>expand</code>, <code>axes</code> y <code>box</code>, a continuación el código usado.</p>
<pre class="sourceCode r"><code class="sourceCode r">media &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">12</span>)
varianza &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">-0.8</span>, <span class="fl">-0.8</span>, <span class="dv">1</span>), <span class="dt">ncol=</span><span class="dv">2</span>)

<span class="kw">require</span>(mvtnorm)
fun &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) <span class="kw">dmvnorm</span>(<span class="kw">c</span>(x, y), <span class="dt">mean=</span>media, <span class="dt">sigma=</span>varianza)
fun &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(fun)

x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">2</span>, <span class="dt">to=</span><span class="dv">8</span>, <span class="dt">length.out=</span><span class="dv">30</span>)
y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">9</span>, <span class="dt">to=</span><span class="dv">15</span>, <span class="dt">length.out=</span><span class="dv">30</span>)
z &lt;-<span class="st"> </span><span class="kw">outer</span>(x, y, fun)

<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>))
<span class="kw">persp</span>(x, y, z, <span class="dt">theta=</span><span class="dv">30</span>, <span class="dt">phi=</span><span class="dv">30</span>, <span class="dt">ticktype =</span> <span class="st">&quot;detailed&quot;</span>, <span class="dt">nticks=</span><span class="dv">4</span>)
<span class="kw">persp</span>(x, y, z, <span class="dt">theta=</span><span class="dv">30</span>, <span class="dt">phi=</span><span class="dv">30</span>, <span class="dt">col=</span><span class="st">&#39;salmon1&#39;</span>, <span class="dt">expand=</span><span class="fl">0.5</span>, <span class="dt">axes=</span><span class="ot">FALSE</span>)
<span class="kw">persp</span>(x, y, z, <span class="dt">theta=</span><span class="dv">30</span>, <span class="dt">phi=</span><span class="dv">30</span>, <span class="dt">col=</span><span class="st">&#39;springgreen1&#39;</span>, <span class="dt">expand=</span><span class="fl">0.2</span>, <span class="dt">box=</span><span class="ot">FALSE</span>)</code></pre>
<div class="figure"><span id="fig:ex2persp"></span>
<img src="Graficos_con_R_files/figure-html/ex2persp-1.png" alt="Distribución normal bivariada." width="768" />
<p class="caption">
Figure 3.16: Distribución normal bivariada.
</p>
</div>
<p>En la Figura <a href="doscuanti.html#fig:ex2persp">3.16</a> se presentan las 3 perspectivas para la densidad. Note los efectos que <code>ticktype</code>, <code>nticks</code>, <code>expand</code>, <code>axes</code> y <code>box</code> tienen sobre los dibujos de las perspectivas.</p>
</div>
</div>
<div id="funcion-contour" class="section level2">
<h2><span class="header-section-number">3.6</span> Función <code>contour</code>  </h2>
<p>La función <code>contour</code> dibuja gráficos contornos. La estructura de la función <code>contour</code> con los argumentos más usuales se muestra a continuación:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">contour</span>(x, y, z,
        xlim, ylim, zlim,
        levels, <span class="dt">nlevels=</span><span class="dv">20</span>, col)</code></pre>
<p>Los argumentos de la función son:</p>
<ul>
<li><code>x, y</code>: vectores numéricos en los cuales se evaluó la función de interés para construir el objeto <code>z</code>. Ambos vectores deben estar ordenados.</li>
<li><code>z</code>: matriz con las alturas de la función de interés, por lo general creada con la función <code>outer</code>.</li>
<li><code>xlim, ylim, zlim</code>: límites de los ejes x, y e z respectivamente.</li>
<li><code>nlevels</code>: número aproximado de niveles o cortes en la superficie a representar.</li>
<li><code>col</code>: color a usar en las líneas de contornos.</li>
</ul>
<p>La función <code>contour</code> tiene otros parámetros adicionales que el lector puede consultar en la ayuda usando <code>help(contour)</code>.</p>
<div id="ejemplo-21" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Generar una muestra aleatoria de 50 observaciones de una distribución normal con parámetros <span class="math inline">\(\mu=170\)</span> y <span class="math inline">\(\sigma^2=25\)</span>. Dibujar un gráfico de contornos para la superficie de log-verosimilitud.</p>
<p>La muestra aleatoria se genera con el siguiente código.</p>
<pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">50</span>, <span class="dt">mean=</span><span class="dv">170</span>, <span class="dt">sd=</span><span class="dv">5</span>)  <span class="co"># sd es desviación</span></code></pre>
<p>Para dibujar los contornos solicitados se debe primero construir la función de log-verosimilitud llamada <code>ll</code>. A continuación el código para crear <code>ll</code>, mayores detalles de cómo construir funciones de log-verosimilitud se pueden consultar en <span class="citation">(<span class="citeproc-not-found" data-reference-id="hernandez_usuga"><strong>???</strong></span>)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">ll &lt;-<span class="st"> </span><span class="cf">function</span>(a, b) <span class="kw">sum</span>(<span class="kw">dnorm</span>(<span class="dt">x=</span>y, <span class="dt">mean=</span>a, <span class="dt">sd=</span>b, <span class="dt">log=</span><span class="ot">TRUE</span>))
ll &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(ll)  <span class="co"># Para vectorizar la función</span></code></pre>
<p>Una vez construída la función <code>ll</code> se deben construir los vectores con las coordenadas horizontal y vertical donde se evalua la función <code>ll</code>. En el código mostrado abajo se tienen dos vectores <code>xx</code> e <code>yy</code> obtenidos como secuencias desde el menor valor hasta el mayor valor para cada uno de los parámetros <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span> de la distribución normal, el valor <code>by=0.5</code> indica el tamaño de paso de la secuencia. Luego se construye la matriz <code>zz</code> usando la función <code>outer</code> evaluando <code>ll</code> en <code>xx</code> e <code>yy</code>. Por último la función <code>contour</code> se aplica sobre los elementos <code>xx</code>, <code>yy</code> e <code>zz</code>. En la Figura <a href="doscuanti.html#fig:contour1">3.17</a> se muestra el gráfico de contornos con aproximadamente 50 niveles.</p>
<pre class="sourceCode r"><code class="sourceCode r">xx &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">160</span>, <span class="dt">to=</span><span class="dv">180</span>, <span class="dt">by=</span><span class="fl">0.5</span>)
yy &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">3</span>, <span class="dt">to=</span><span class="dv">7</span>, <span class="dt">by=</span><span class="fl">0.5</span>)
zz &lt;-<span class="st"> </span><span class="kw">outer</span>(<span class="dt">X=</span>xx, <span class="dt">Y=</span>yy, ll)
<span class="kw">contour</span>(<span class="dt">x=</span>xx, <span class="dt">y=</span>yy, <span class="dt">z=</span>zz, <span class="dt">nlevels=</span><span class="dv">50</span>,
        <span class="dt">col=</span><span class="kw">gray</span>(<span class="fl">0.3</span>), <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="st">&#39;solid&#39;</span>,
        <span class="dt">xlab=</span><span class="kw">expression</span>(mu), <span class="dt">ylab=</span><span class="kw">expression</span>(sigma))</code></pre>
<div class="figure"><span id="fig:contour1"></span>
<img src="Graficos_con_R_files/figure-html/contour1-1.png" alt="Gráfico de contornos para la función de log-verosimilitud para el ejemplo sobre normal." width="672" />
<p class="caption">
Figure 3.17: Gráfico de contornos para la función de log-verosimilitud para el ejemplo sobre normal.
</p>
</div>
</div>
</div>
<div id="funcion-filled.contour" class="section level2">
<h2><span class="header-section-number">3.7</span> Función <code>filled.contour</code>  </h2>
<p>La función <code>filled.contour</code> dibuja gráficos contornos pero usando una paleta de colores, este tipo de representación se denomina gráfico de nivel. La estructura de la función <code>filled.contour</code> con los argumentos más usuales se muestra a continuación:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filled.contour</span>(x, y, z,
               xlim, ylim, zlim,
               levels, <span class="dt">nlevels=</span><span class="dv">20</span>,
               <span class="dt">color.palette=</span>cm.colors, col)</code></pre>
<p>Los argumentos de la función son:</p>
<ul>
<li><code>x, y</code>: vectores numéricos en los cuales se evaluó la función de interés para construir el objeto <code>z</code>. Ambos vectores deben estar ordenados.</li>
<li><code>z</code>: matriz con las alturas de la función de interés, por lo general creada con la función <code>outer</code>.</li>
<li><code>xlim, ylim, zlim</code>: límites de los ejes x, y e z respectivamente.</li>
<li><code>nlevels</code>: número aproximado de niveles o cortes en la superficie a representar.</li>
<li><code>color.palette</code>: paleta de colores a usar. Por defecto es <code>cm.colors</code> pero el usuario puede elegir entre <code>heat.colors</code>, <code>terrain.colors</code> o <code>topo.colors</code>.</li>
</ul>
<p>La función <code>filled.contour</code> tiene otros parámetros adicionales que el lector puede consultar en la ayuda usando <code>help(filled.contour)</code>.</p>
<div id="ejemplo-22" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Abajo se muestra el código para crear un gráfico de nivel usando los datos del ejemplo anterior. Observe que las figuras <a href="doscuanti.html#fig:contour1">3.17</a> y <a href="doscuanti.html#fig:contour2">3.18</a> son bastante similares.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filled.contour</span>(<span class="dt">x=</span>xx, <span class="dt">y=</span>yy, <span class="dt">z=</span>zz, <span class="dt">nlevels=</span><span class="dv">20</span>,
               <span class="dt">xlab=</span><span class="kw">expression</span>(mu), <span class="dt">ylab=</span><span class="kw">expression</span>(sigma),
               <span class="dt">color =</span> topo.colors)</code></pre>
<div class="figure"><span id="fig:contour2"></span>
<img src="Graficos_con_R_files/figure-html/contour2-1.png" alt="Gráfico de nivel para la función de log-verosimilitud para el ejemplo sobre normal." width="672" />
<p class="caption">
Figure 3.18: Gráfico de nivel para la función de log-verosimilitud para el ejemplo sobre normal.
</p>
</div>
</div>
<div id="ejemplo-23" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>¿Es posible crear un gráfico de contornos y de niveles en la misma figura?</p>
<p>Claro que si, abajo se muestra el código para crear primero el gráfico de niveles (en colores) y luego superponer el gráficos de contornos (las lineas). En la Figura <a href="doscuanti.html#fig:contour3">3.19</a> se muestra el gráfico resultante.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filled.contour</span>(<span class="dt">x=</span>xx, <span class="dt">y=</span>yy, <span class="dt">z=</span>zz,  <span class="dt">nlevels=</span><span class="dv">20</span>,
               <span class="dt">color.palette =</span> topo.colors, 
               <span class="dt">plot.axes=</span><span class="kw">contour</span>(xx, yy, zz, <span class="dt">nlevels=</span><span class="dv">20</span>, <span class="dt">add=</span><span class="ot">TRUE</span>))</code></pre>
<div class="figure"><span id="fig:contour3"></span>
<img src="Graficos_con_R_files/figure-html/contour3-1.png" alt="Gráfico de nivel y contornos para la función de log-verosimilitud para el ejemplo sobre normal." width="672" />
<p class="caption">
Figure 3.19: Gráfico de nivel y contornos para la función de log-verosimilitud para el ejemplo sobre normal.
</p>
</div>
</div>
</div>
<div id="funcion-image" class="section level2">
<h2><span class="header-section-number">3.8</span> Función <code>image</code> </h2>
<p>La función <code>image</code> dibuja un gráfico de calor similar al obtenido con la función <code>filled.contour</code>. La estructura de la función <code>image</code> con los argumentos más usuales se muestra a continuación:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">image</span>(x, y, z)</code></pre>
<p>Los argumentos de la función son:</p>
<ul>
<li><code>x, y</code>: vectores numéricos en los cuales se evaluó la función de interés para construir el objeto <code>z</code>. Ambos vectores deben estar ordenados.</li>
<li><code>z</code>: matriz con las alturas de la función de interés, por lo general creada con la función <code>outer</code>.</li>
</ul>
<div id="ejemplo-24" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Para la muestra aleatoria obtenida en el ejemplo anterior, dibujar un gráfico con <code>image</code> para la superficie de log-verosimilitud.</p>
<p>Usando los objetos <code>xx</code>, <code>yy</code> e <code>zz</code> creados en el ejemplo anterior se puede construir el gráfico solicitado, a continuación el código utilizado. En la Figura <a href="doscuanti.html#fig:image1">3.20</a> se muestra el gráfico.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">image</span>(<span class="dt">x=</span>xx, <span class="dt">y=</span>yy, <span class="dt">z=</span>zz,
      <span class="dt">xlab=</span><span class="kw">expression</span>(mu), <span class="dt">ylab=</span><span class="kw">expression</span>(sigma))</code></pre>
<div class="figure"><span id="fig:image1"></span>
<img src="Graficos_con_R_files/figure-html/image1-1.png" alt="Gráfico para la función de log-verosimilitud para el ejemplo sobre normal." width="864" />
<p class="caption">
Figure 3.20: Gráfico para la función de log-verosimilitud para el ejemplo sobre normal.
</p>
</div>
</div>
</div>
<div id="funcion-kde2d" class="section level2">
<h2><span class="header-section-number">3.9</span> Función <code>kde2d</code>  </h2>
<p>La función <code>kde2d</code> pertenece al paquete <code>MASS</code> y es utilizada para crear densidades para dos variables cuantitativas. La estructura de la función <code>kde2d</code> con los argumentos más usuales se muestra a continuación:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kde2d</span>(x, y, h, <span class="dt">n =</span> <span class="dv">25</span>, <span class="dt">lims =</span> <span class="kw">c</span>(<span class="kw">range</span>(x), <span class="kw">range</span>(y)))</code></pre>
<p>Los argumentos de la función son:</p>
<ul>
<li><code>x</code>: vector con la variable para el eje X.</li>
<li><code>y</code>: vector con la variable para el eje Y..</li>
<li><code>h</code>: vector con los anchos de banda en las direcciones X e Y.</li>
<li><code>n</code>: número de puntos para construir la rejilla.</li>
<li><code>lims</code>: límites del rectángulo de datos a considerar, debe ser un vector de la forma <code>c(xl, xu, yl, yu)</code>. Este parámetro por defecto es <code>c(range(x), range(y))</code>.</li>
</ul>
<div id="ejemplo-25" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>La base de datos medidas del cuerpo cuenta con 6 variables registradas
a un grupo de 36 estudiantes de la universidad, dos de esas variables son la altura y el peso corporal. Se desea construir un gráfico de densidad bivariada para altura y peso.</p>
<p>El código mostrado a continuación hace la lectura de la base de datos y luego se construyen dos densidades, la primera con <code>n=5</code> y la segunda con <code>n=50</code>, esto para ver el efecto del parámetro <code>n</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">url &lt;-<span class="st"> &#39;https://raw.githubusercontent.com/fhernanb/datos/master/medidas_cuerpo&#39;</span>
datos &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">file=</span>url, <span class="dt">header=</span>T)

<span class="kw">require</span>(MASS)  <span class="co"># Se debe cargar este paquete</span>
f1 &lt;-<span class="st"> </span><span class="kw">kde2d</span>(<span class="dt">x=</span>datos<span class="op">$</span>peso, <span class="dt">y=</span>datos<span class="op">$</span>altura, <span class="dt">n=</span><span class="dv">5</span>)
f2 &lt;-<span class="st"> </span><span class="kw">kde2d</span>(<span class="dt">x=</span>datos<span class="op">$</span>peso, <span class="dt">y=</span>datos<span class="op">$</span>altura, <span class="dt">n=</span><span class="dv">50</span>)</code></pre>
<p>En el código mostrado a continuación se dibujan las dos densidades usando un gráfico de calor usando la función <code>image</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">image</span>(f1, <span class="dt">xlab=</span><span class="st">&#39;Peso&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Estatura&#39;</span>, <span class="dt">main=</span><span class="st">&#39;n=5&#39;</span>)
<span class="kw">image</span>(f2, <span class="dt">xlab=</span><span class="st">&#39;Peso&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Estatura&#39;</span>, <span class="dt">main=</span><span class="st">&#39;n=50&#39;</span>)</code></pre>
<div class="figure"><span id="fig:den2d1"></span>
<img src="Graficos_con_R_files/figure-html/den2d1-1.png" alt="Gráfico de densidad bivariada para el peso corporal y la estatura de un grupo de estudiantes. A la izquierda la densidad con `n=5` y a la derecha con `n=50`." width="960" />
<p class="caption">
Figure 3.21: Gráfico de densidad bivariada para el peso corporal y la estatura de un grupo de estudiantes. A la izquierda la densidad con <code>n=5</code> y a la derecha con <code>n=50</code>.
</p>
</div>
</div>
</div>
<div id="funcion-interaction.plot" class="section level2">
<h2><span class="header-section-number">3.10</span> Función <code>interaction.plot</code>  </h2>
<p>La función <code>interaction.plot</code> dibuja gráficos de interacción. La estructura de la función <code>interaction.plot</code> con los argumentos más usuales se muestra a continuación:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">interaction.plot</span>(response, x.factor, trace.factor, fun,
                 legend, trace.label)</code></pre>
<p>Los argumentos de la función son:</p>
<ul>
<li><code>response</code>: vector numérico con la variable respuesta.</li>
<li><code>x.factor</code>: factor 1 a ubicar en el eje horizontal.</li>
<li><code>trace.factor</code>: factor 2 para diferenciar las líneas.</li>
<li><code>fun</code>: función a aplicar para a <code>response</code> para cada combinación de <code>x.factor</code> y <code>trace.factor</code>.</li>
<li><code>legend</code>: valor lógico para incluir o no leyenda.</li>
<li><code>trace.label</code>: nombre a colocar en la leyenda.</li>
</ul>
<p>La función <code>interaction.plot</code> tiene otros parámetros adicionales que el lector puede consultar en la ayuda usando <code>help(interaction.plot)</code>.</p>
<div id="ejemplo-26" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Se realizó un experimento para determinar cómo influye el material de la batería y la temperatura del medio ambiente sobre la duración en horas de la batería. Se desea construir un gráfico de interacción entre Temperatura y Material para ver el efecto sobre la duración promedio de las baterías. Los datos y el código para generar el gráfico solicitado se muestran a continuación.</p>
<pre class="sourceCode r"><code class="sourceCode r">horas &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">130</span>, <span class="dv">155</span>, <span class="dv">74</span>, <span class="dv">180</span>, <span class="dv">150</span>, <span class="dv">188</span>, <span class="dv">159</span>, <span class="dv">126</span>, <span class="dv">138</span>, <span class="dv">110</span>, <span class="dv">168</span>, 
           <span class="dv">160</span>, <span class="dv">34</span>, <span class="dv">40</span>, <span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">136</span>, <span class="dv">122</span>, <span class="dv">106</span>, <span class="dv">115</span>, <span class="dv">174</span>, <span class="dv">120</span>, <span class="dv">150</span>, 
           <span class="dv">139</span>, <span class="dv">20</span>, <span class="dv">70</span>, <span class="dv">82</span>, <span class="dv">58</span>, <span class="dv">25</span>, <span class="dv">70</span>, <span class="dv">58</span>, <span class="dv">45</span>, <span class="dv">96</span>, <span class="dv">104</span>, <span class="dv">82</span>, <span class="dv">60</span>)

temperatura &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">15</span>, <span class="dv">70</span>, <span class="dv">125</span>), <span class="dt">each=</span><span class="dv">12</span>)
material    &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">each=</span><span class="dv">4</span>, <span class="dt">times=</span><span class="dv">3</span>)

<span class="kw">interaction.plot</span>(<span class="dt">x.factor=</span>temperatura, <span class="dt">trace.factor=</span>material,
                 <span class="dt">response=</span>horas, <span class="dt">trace.label=</span><span class="st">&#39;Material&#39;</span>,
                 <span class="dt">xlab=</span><span class="st">&#39;Temperatura&#39;</span>,
                 <span class="dt">ylab=</span><span class="st">&#39;Duración promedio (horas)&#39;</span>,
                 <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;dodgerblue3&#39;</span>, <span class="st">&#39;chartreuse4&#39;</span>, <span class="st">&#39;salmon3&#39;</span>),
                 <span class="dt">fun=</span>mean, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">fixed=</span>T)</code></pre>
<div class="figure"><span id="fig:intplot1"></span>
<img src="Graficos_con_R_files/figure-html/intplot1-1.png" alt="Gráfico de interacción entre Temperatura y Material sobre la duración promedio de las baterías." width="672" />
<p class="caption">
Figure 3.22: Gráfico de interacción entre Temperatura y Material sobre la duración promedio de las baterías.
</p>
</div>
</div>
</div>
<div id="grafico-de-espagueti" class="section level2">
<h2><span class="header-section-number">3.11</span> Gráfico de espagueti </h2>
<p>Los gráficos de espagueti son usados para representar la evolución de una variable medida para un grupo de sujetos en diferentes momentos del tiempo. La función <code>interaction.plot</code> se puede usar para obtener este tipo de gráficos, a continuación un ejemplo.</p>
<div id="ejemplo-27" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>El ejemplo aquí presentado fue tomado de este <a href="http://stats.idre.ucla.edu/r/faq/how-can-i-make-spaghetti-plots/">enlace</a>. El objetivo es crear un gráfico de espagueti para mostrar la evolución de la variable tolerancia a través del tiempo para cada uno de los 16 individuos estudiados. El código para descargar la base de datos y construir el gráfico se muestran a continuación.</p>
<pre class="sourceCode r"><code class="sourceCode r">dt &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;https://stats.idre.ucla.edu/stat/r/faq/tolpp.csv&quot;</span>,
                 <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>, <span class="dt">header=</span>T)

<span class="kw">require</span>(gplots)           <span class="co"># Paquete especial para crear una paleta</span>
<span class="kw">palette</span>(<span class="kw">rich.colors</span>(<span class="dv">16</span>))  <span class="co"># de 16 colores diferentes y suaves</span>

<span class="kw">interaction.plot</span>(<span class="dt">response=</span>dt<span class="op">$</span>tolerance,
                 <span class="dt">x.factor=</span>dt<span class="op">$</span>time, <span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">16</span>, <span class="dt">lwd=</span><span class="dv">2</span>,
                 <span class="dt">trace.factor=</span>dt<span class="op">$</span>id, <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">lty=</span><span class="dv">1</span>, 
                 <span class="dt">xlab=</span><span class="st">&quot;Tiempo&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Tolerancia&quot;</span>, <span class="dt">legend=</span>F)</code></pre>
<div class="figure"><span id="fig:intplot2"></span>
<img src="Graficos_con_R_files/figure-html/intplot2-1.png" alt="Gráfico de espagueti para ver la evolución de la variable tolerancia." width="672" />
<p class="caption">
Figure 3.23: Gráfico de espagueti para ver la evolución de la variable tolerancia.
</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="unacuanti.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cuali.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fhernanb/Graficos-con-R/edit/master/03_graphs2v.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
